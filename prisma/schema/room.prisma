enum RoomStatus {
  ACTIVE
  CLOSED
}

enum RoomType {
  CLASSROOM
  LAB
  AUDITORIUM
  STAFF_ROOM
  EXAM_HALL
}

model Room {
  id       Int @id @default(autoincrement())
  schoolId Int

  name  String
  code  String?
  block String?
  floor Int?

  roomType RoomType

  status RoomStatus @default(ACTIVE)

  capacity   Int?     @default(30)
  facilities String[] @default([])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  school             School              @relation(fields: [schoolId], references: [id], onDelete: Cascade)
  assignments        RoomAssignment[]
  timetableEntries   TimetableEntry[]
  timetableOverrides TimetableOverride[]

  @@unique([schoolId, code])
  @@index([schoolId])
}

model RoomAssignment {
  id             Int @id @default(autoincrement())
  schoolId       Int
  academicYearId Int

  roomId    Int
  sectionId Int

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  room           Room          @relation(fields: [roomId], references: [id], onDelete: Cascade)
  section        Section       @relation(fields: [sectionId], references: [id], onDelete: Cascade)
  school         School        @relation(fields: [schoolId], references: [id], onDelete: Cascade)
  academicYear   AcademicYear  @relation(fields: [academicYearId], references: [id], onDelete: Cascade)
  classSubject   ClassSubject? @relation(fields: [classSubjectId], references: [id])
  classSubjectId Int?

  @@unique([schoolId, academicYearId, sectionId])
  @@index([roomId])
}
